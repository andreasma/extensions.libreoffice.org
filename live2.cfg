[buildout]

index=https://pypi.python.org/simple

extends=
    buildout.d/plone-5.2.x.cfg
    buildout.d/sources.cfg
    buildout.d/core.cfg
    versions.cfg

parts =
    zeo
    instance1
    instance2
    supervisor
    
eggs +=
   raven
   tdf.templateuploadcenter
   tdf.extensionuploadcenter
   Products.validation
   
[settings]
default-user = plone
instance1-host = 127.0.0.1
instance2-host = 127.0.0.1
instance3-host = 127.0.0.1
instance4-host = 127.0.0.1
instance1-port = 8081
instance2-port = 8082
instance3-port = 8083
instance4-port = 8084
instance-debug-port = 8085
effective-user = ${settings:default-user}
instance-user = admin
instance-password = admin
policy-package =
shared-blob = on
zeo-port = 8088

supervisor-host = 127.0.0.1
supervisor-port = 8089
supervisor-user = ${settings:default-user}
supervisor-password = secret


[zeo]
recipe = plone.recipe.zeoserver[zrs]
zeo-address = ${settings:zeo-port}
blob-storage = ${buildout:directory}/var/blobstorage
file-storage = ${buildout:directory}/var/filestorage/Data.fs


[instance1]
recipe = plone.recipe.zope2instance
zeo-client = true
zeo-address = ${zeo:zeo-address}
blob-storage = ${zeo:blob-storage}
shared-blob = on
zserver-threads = 4
http-fast-listen = off
http-address = ${settings:instance1-port}
zeo-client = true
debug-mode = off
verbose-security = off
effective-user = ${settings:effective-user}
instance-user = admin
instance-password = admin
eggs= ${buildout:eggs}


[instance2]
<= instance1
http-address = ${settings:instance2-port}


[supervisor]
recipe = collective.recipe.supervisor
port = ${settings:supervisor-host}:${settings:supervisor-port}
user = ${settings:supervisor-user}
password = ${settings:supervisor-password}
programs =
    30 zeo ${buildout:directory}/bin/zeo [console] true
    40 instance1 ${buildout:directory}/bin/instance1 [console] true
    50 instance2 ${buildout:directory}/bin/instance2 [console] true


